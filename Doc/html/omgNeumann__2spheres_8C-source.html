<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DENDRO: /net/ac190/www-db1/grads/r/rahulss/Dendro/examples/omgNeumann_2spheres.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a></div>
<h1>omgNeumann_2spheres.C</h1><a href="omgNeumann__2spheres_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;mpi.h&gt;</span>
00002 <span class="preprocessor">#include &lt;cstdio&gt;</span>
00003 <span class="preprocessor">#include "<a class="code" href="oda_8h.html">oda.h</a>"</span>
00004 <span class="preprocessor">#include "<a class="code" href="omg_8h.html">omg.h</a>"</span>
00005 <span class="preprocessor">#include "<a class="code" href="Point_8h.html">Point.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="parUtils_8h.html">parUtils.h</a>"</span>
00007 <span class="preprocessor">#include "<a class="code" href="octUtils_8h.html">octUtils.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="TreeNode_8h.html">TreeNode.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="handleStencils_8h.html">handleStencils.h</a>"</span>
00010 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00011 <span class="preprocessor">#include "<a class="code" href="sys_8h.html">sys.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="externVars_8h.html">externVars.h</a>"</span>
00013 <span class="preprocessor">#include &lt;sstream&gt;</span>
00014 <span class="preprocessor">#include "<a class="code" href="omgNeumann_8h.html">omgNeumann.h</a>"</span>
00015 
00016 <span class="comment">//Don't want time to be synchronized. Need to check load imbalance.</span>
00017 <span class="preprocessor">#ifdef MPI_WTIME_IS_GLOBAL</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#undef MPI_WTIME_IS_GLOBAL</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00020 <span class="preprocessor"></span>
00021 <span class="preprocessor">#ifdef PETSC_USE_LOG</span>
00022 <span class="preprocessor"></span>
00023 <span class="keywordtype">int</span> Jac2DiagEvent;
00024 <span class="keywordtype">int</span> Jac2MultEvent;
00025 <span class="keywordtype">int</span> Jac2FinestDiagEvent;
00026 <span class="keywordtype">int</span> Jac2FinestMultEvent;
00027 
00028 <span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>
<a name="l00030"></a><a class="code" href="omgNeumann__2spheres_8C.html#a0">00030</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a> = 1;  <span class="comment">// frequency for test purposes</span>
<a name="l00031"></a><a class="code" href="omgNeumann__2spheres_8C.html#a1">00031</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a1">c_x</a> =0.5;
<a name="l00032"></a><a class="code" href="omgNeumann__2spheres_8C.html#a2">00032</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a2">c_y</a> =0.5;
<a name="l00033"></a><a class="code" href="omgNeumann__2spheres_8C.html#a3">00033</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a3">c_z</a> =0.5;
<a name="l00034"></a><a class="code" href="omgNeumann__2spheres_8C.html#a4">00034</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a> = 0.2;
<a name="l00035"></a><a class="code" href="omgNeumann__2spheres_8C.html#a5">00035</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a> = 0.4;
<a name="l00036"></a><a class="code" href="omgNeumann__2spheres_8C.html#a6">00036</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="omgNeumann__2spheres_8C.html#a6">penalty</a> = 1e8;
00037 
<a name="l00038"></a><a class="code" href="omgNeumann__2spheres_8C.html#a7">00038</a> <span class="keywordtype">void</span> <a class="code" href="omgNeumann__ex3_8C.html#a1">CalcVarCoef</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp; pts, std::vector&lt;double&gt; &amp; coef)
00039 {
00040   <span class="keyword">const</span> <span class="keywordtype">double</span> inS = <a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>*inneR;
00041   <span class="keyword">const</span> <span class="keywordtype">double</span> outS = <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a>*outeR;
00042   
00043   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0,j=0; i&lt;pts.size(); i+=3,j+=2)
00044   {
00045     <span class="keywordtype">double</span> s = (pts[i]-c_x)*(pts[i]-c_x) + (pts[i+1]-c_y)*(pts[i+1]-c_y) + (pts[i+2]-c_z)*(pts[i+2]-c_z);   
00046     
00047     <span class="keywordflow">if</span> ( s&gt;=inS &amp;&amp; s&lt;=outS )
00048     {
00049       <span class="comment">// we are inside the domain</span>
00050       coef[j]=1;   <span class="comment">// weight of -div grad u</span>
00051       coef[j+1]=0; <span class="comment">// weight of u</span>
00052     }
00053     <span class="keywordflow">else</span>
00054     {
00055       <span class="comment">// we are outside the domain</span>
00056       coef[j]=1;
00057       coef[j+1]=penalty;
00058     }
00059   }
00060 }
00061 
<a name="l00062"></a><a class="code" href="omgNeumann__2spheres_8C.html#a8">00062</a> <span class="keywordtype">void</span> <a class="code" href="omgNeumann__ex3_8C.html#a2">CalcVarRHS</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp; pts, std::vector&lt;double&gt; &amp; rhs)
00063 {
00064   <span class="keyword">const</span> <span class="keywordtype">double</span> inS = <a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>*inneR;
00065   <span class="keyword">const</span> <span class="keywordtype">double</span> outS = <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a>*outeR;
00066   <span class="keyword">const</span> <span class="keywordtype">double</span> l = <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a>-inneR;
00067   
00068   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0,j=0; i&lt;pts.size(); i+=3,j++)
00069   {
00070    
00071     <span class="keywordtype">double</span> s = (pts[i]-c_x)*(pts[i]-c_x) + (pts[i+1]-c_y)*(pts[i+1]-c_y) + (pts[i+2]-c_z)*(pts[i+2]-c_z);    
00072     <span class="keywordflow">if</span> ( s&gt;=inS &amp;&amp; s&lt;=outS )
00073     {
00074       <span class="comment">// we are inside the domain</span>
00075       <span class="keywordtype">double</span> r = sqrt(s);
00076       rhs[j]= <a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a>*<a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a>*M_PI*M_PI/l/l*sin(<a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a>*M_PI*(r-<a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>)/l)/r; 
00077     }
00078     <span class="keywordflow">else</span>
00079     {
00080       <span class="comment">// we are outside the domain</span>
00081       rhs[j]=0;
00082     }
00083   }
00084 }
00085 
<a name="l00086"></a><a class="code" href="omgNeumann__2spheres_8C.html#a9">00086</a> <span class="keywordtype">int</span> <a class="code" href="testShFn_8C.html#a8">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> ** argv )
00087 {
00088   PetscInitialize(&amp;argc,&amp;argv,<span class="stringliteral">"options"</span>,<span class="stringliteral">"DENDRO example\n"</span>);
00089   <a class="code" href="namespaceot.html#a134">ot::RegisterEvents</a>();
00090 
00091   <a class="code" href="namespaceot.html#a89">ot::DAMG_Initialize</a>(MPI_COMM_WORLD);
00092 
00093   <span class="keywordtype">int</span> size, rank;
00094   MPI_Comm_size(MPI_COMM_WORLD,&amp;size);
00095   MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);
00096 
00097   <span class="keywordflow">if</span> (argc&lt;2) 
00098   {
00099     std::cout&lt;&lt;<span class="stringliteral">"Usage: mpirun -np &lt;numProcs&gt; "</span>&lt;&lt;argv[0]&lt;&lt;<span class="stringliteral">" &lt;filePrefix&gt;"</span>&lt;&lt;std::endl;
00100     <span class="keywordflow">return</span>(-1);
00101   }
00102 
00103   std::ostringstream fName;
00104   fName&lt;&lt;argv[1]&lt;&lt;rank&lt;&lt;<span class="stringliteral">"_"</span>&lt;&lt;size&lt;&lt;<span class="stringliteral">".ot"</span>;
00105 
00106   std::vector&lt;ot::TreeNode&gt; octs;
00107   <a class="code" href="namespaceot.html#a52">ot::readNodesFromFile</a>(const_cast&lt;char*&gt;(fName.str().c_str()), octs);
00108   
00109   Vec sol;
00110   <a class="code" href="structot_1_1__p__DAMG.html">ot::DAMG</a> * damg;
00111   
00112   <span class="comment">// This function pointer will be called while setting up the solver on the coarsest grid if not all processes are active on the coarse grid </span>
00113   ot::getPrivateMatricesForKSP_Shell = getPrivateMatricesForKSP_Shell_Jac2;
00114 
00115   <a class="code" href="omgNeumann_8h.html#a2">solve_neumann_oct</a>(
00116     <span class="comment">/* input parameters: */</span>
00117      octs,
00118      <a class="code" href="omgNeumann__2spheres_8C.html#a7">CalcVarCoef</a>,
00119      <a class="code" href="omgNeumann__2spheres_8C.html#a8">CalcVarRHS</a>,
00120      100,
00121 
00122      <span class="comment">/* output parameters */</span>
00123      sol,
00124      damg
00125     );
00126  
00127   <span class="comment">// compare solution with the exact one</span>
00128   <span class="keywordtype">unsigned</span> numMultigridLevels = damg[0]-&gt;<a class="code" href="structot_1_1__p__DAMG.html#o17">totalLevels</a>;
00129   <a class="code" href="classot_1_1DA.html">ot::DA</a>* da=damg[numMultigridLevels-1]-&gt;<a class="code" href="structot_1_1__p__DAMG.html#o3">da</a>;
00130   PetscScalar *solArray;
00131   da-&gt;<a class="code" href="classot_1_1DA.html#z35_11">vecGetBuffer</a>(sol,solArray,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">true</span>,1);
00132   <span class="keywordtype">double</span> maxDiff = 0;
00133   <span class="keywordtype">unsigned</span> maxDepth=da-&gt;<a class="code" href="classot_1_1DA.html#z31_16">getMaxDepth</a>()-1;
00134   <span class="keywordtype">double</span> l = <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a> - inneR;
00135 
00136   <span class="keywordflow">if</span>(da-&gt;<a class="code" href="classot_1_1DA.html#a5">iAmActive</a>())
00137   { 
00138     <span class="keywordtype">double</span> outeS = <a class="code" href="omgNeumann__2spheres_8C.html#a5">outeR</a>*outeR;
00139     <span class="keywordtype">double</span> inneS = <a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>*inneR;
00140     
00141     <span class="comment">// first loop over those octants which do not contain ghost nodes.</span>
00142     <span class="keywordflow">for</span>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_9">init</a>&lt;ot::DA_FLAGS::INDEPENDENT&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>() &lt; da-&gt;<a class="code" href="classot_1_1DA.html#z36_2">end</a>&lt;ot::DA_FLAGS::INDEPENDENT&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#z36_13">next</a>&lt;ot::DA_FLAGS::INDEPENDENT&gt;())  
00143     {
00144       <a class="code" href="classPoint.html">Point</a> pt = da-&gt;<a class="code" href="classot_1_1DA.html#z31_3">getCurrentOffset</a>();
00145       <span class="keywordtype">unsigned</span> levelhere = da-&gt;<a class="code" href="classot_1_1DA.html#z36_6">getLevel</a>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>()) - 1;
00146       <span class="keywordtype">double</span> hxOct = ldexp(1.0,-levelhere);
00147       <span class="keywordtype">double</span> x = ldexp(pt.<a class="code" href="classPoint.html#z52_0">x</a>(),-maxDepth );
00148       <span class="keywordtype">double</span> y = ldexp(pt.<a class="code" href="classPoint.html#z52_2">y</a>(),-maxDepth );
00149       <span class="keywordtype">double</span> z = ldexp(pt.<a class="code" href="classPoint.html#z52_4">z</a>(),-maxDepth );
00150 
00151       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indices[8];
00152       da-&gt;<a class="code" href="classot_1_1DA.html#z36_7">getNodeIndices</a>(indices); 
00153 
00154       <span class="keywordtype">double</span> coord[8][3] = {
00155         {0.0,0.0,0.0},
00156         {1.0,0.0,0.0},
00157         {0.0,1.0,0.0},
00158         {1.0,1.0,0.0},
00159         {0.0,0.0,1.0},
00160         {1.0,0.0,1.0},
00161         {0.0,1.0,1.0},
00162         {1.0,1.0,1.0}
00163       };
00164 
00165       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hn = da-&gt;<a class="code" href="classot_1_1DA.html#z36_5">getHangingNodeIndex</a>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>());
00166 
00167       <span class="keywordtype">double</span> s = (x+hxOct/2-c_x)*(x+hxOct/2-c_x) + (y+hxOct/2-c_y)*(y+hxOct/2-c_y) + (z+hxOct/2-c_z)*(z+hxOct/2-c_z) ;
00168       <span class="keywordflow">if</span> (s&lt;inneS || s&gt;outeS)
00169         <span class="keywordflow">continue</span>; <span class="comment">// octant outside the domain, don't account for the error on any of its nodes</span>
00170 
00171       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)
00172         <span class="keywordflow">if</span> (!(hn &amp; (1 &lt;&lt; i)))
00173         {
00174           <span class="keywordtype">double</span> xhere, yhere, zhere;
00175           xhere = x + coord[i][0]*hxOct; 
00176           yhere = y + coord[i][1]*hxOct; 
00177           zhere = z + coord[i][2]*hxOct; 
00178 
00179           <span class="keywordtype">double</span> rhere = sqrt( (xhere-<a class="code" href="omgNeumann__2spheres_8C.html#a1">c_x</a>)*(xhere-<a class="code" href="omgNeumann__2spheres_8C.html#a1">c_x</a>) + (yhere-<a class="code" href="omgNeumann__2spheres_8C.html#a2">c_y</a>)*(yhere-<a class="code" href="omgNeumann__2spheres_8C.html#a2">c_y</a>) + (zhere-<a class="code" href="omgNeumann__2spheres_8C.html#a3">c_z</a>)*(zhere-<a class="code" href="omgNeumann__2spheres_8C.html#a3">c_z</a>) );
00180           
00181           <span class="keywordtype">double</span> currDiff;
00182           <span class="keywordflow">if</span> (rhere&lt;inneR || rhere&gt;outeR)
00183             <span class="keywordflow">continue</span>; <span class="comment">// solution should be zero here, don't account for error</span>
00184           <span class="keywordflow">else</span>
00185           {
00186             <span class="comment">// debug</span>
00187             <span class="comment">// cout&lt;&lt;rhere&lt;&lt;" "&lt;&lt; solArray[indices[i]]&lt;&lt;endl;</span>
00188             currDiff = fabs ( solArray[indices[i]] - sin(<a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a>*M_PI*(rhere-<a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>)/l)/rhere );
00189           }
00190           
00191           <span class="keywordflow">if</span> (maxDiff &lt; currDiff)
00192             maxDiff=currDiff;
00193         }
00194     }  
00195     
00196     <span class="comment">// now loop over those octants which DO contain ghost nodes; now we need to  check if the node is ghost, and skip it if it is</span>
00197     size_t myFirstNode = da-&gt;<a class="code" href="classot_1_1DA.html#z31_9">getIdxElementBegin</a>();
00198     size_t postFirstNode = da-&gt;<a class="code" href="classot_1_1DA.html#z31_11">getIdxPostGhostBegin</a>();
00199     <span class="keywordflow">for</span>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_9">init</a>&lt;ot::DA_FLAGS::DEPENDENT&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>() &lt; da-&gt;<a class="code" href="classot_1_1DA.html#z36_2">end</a>&lt;ot::DA_FLAGS::DEPENDENT&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#z36_13">next</a>&lt;ot::DA_FLAGS::DEPENDENT&gt;())  
00200     {
00201       <a class="code" href="classPoint.html">Point</a> pt = da-&gt;<a class="code" href="classot_1_1DA.html#z31_3">getCurrentOffset</a>();
00202       <span class="keywordtype">unsigned</span> levelhere = da-&gt;<a class="code" href="classot_1_1DA.html#z36_6">getLevel</a>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>()) - 1;
00203       <span class="keywordtype">double</span> hxOct = ldexp(1.0,-levelhere);
00204       <span class="keywordtype">double</span> x = ldexp(pt.<a class="code" href="classPoint.html#z52_0">x</a>(),-maxDepth );
00205       <span class="keywordtype">double</span> y = ldexp(pt.<a class="code" href="classPoint.html#z52_2">y</a>(),-maxDepth );
00206       <span class="keywordtype">double</span> z = ldexp(pt.<a class="code" href="classPoint.html#z52_4">z</a>(),-maxDepth );
00207 
00208       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indices[8];
00209       da-&gt;<a class="code" href="classot_1_1DA.html#z36_7">getNodeIndices</a>(indices); 
00210 
00211       <span class="keywordtype">double</span> coord[8][3] = {
00212         {0.0,0.0,0.0},
00213         {1.0,0.0,0.0},
00214         {0.0,1.0,0.0},
00215         {1.0,1.0,0.0},
00216         {0.0,0.0,1.0},
00217         {1.0,0.0,1.0},
00218         {0.0,1.0,1.0},
00219         {1.0,1.0,1.0}
00220       };
00221 
00222       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hn = da-&gt;<a class="code" href="classot_1_1DA.html#z36_5">getHangingNodeIndex</a>(da-&gt;<a class="code" href="classot_1_1DA.html#z36_0">curr</a>());
00223 
00224       <span class="keywordtype">double</span> s = (x+hxOct/2-c_x)*(x+hxOct/2-c_x) + (y+hxOct/2-c_y)*(y+hxOct/2-c_y) + (z+hxOct/2-c_z)*(z+hxOct/2-c_z) ;
00225       <span class="keywordflow">if</span> (s&lt;inneS || s&gt;outeS)
00226         <span class="keywordflow">continue</span>; <span class="comment">// octant outside the domain, don't account for the error on any of its nodes</span>
00227       
00228       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)
00229         <span class="keywordflow">if</span> ( indices[i]&gt;=myFirstNode &amp;&amp; indices[i]&lt;postFirstNode &amp;&amp; !(hn &amp; (1 &lt;&lt; i)) )
00230         {
00231           <span class="keywordtype">double</span> xhere, yhere, zhere;
00232           xhere = x + coord[i][0]*hxOct; 
00233           yhere = y + coord[i][1]*hxOct; 
00234           zhere = z + coord[i][2]*hxOct; 
00235 
00236           <span class="keywordtype">double</span> rhere = sqrt( (xhere-<a class="code" href="omgNeumann__2spheres_8C.html#a1">c_x</a>)*(xhere-<a class="code" href="omgNeumann__2spheres_8C.html#a1">c_x</a>) + (yhere-<a class="code" href="omgNeumann__2spheres_8C.html#a2">c_y</a>)*(yhere-<a class="code" href="omgNeumann__2spheres_8C.html#a2">c_y</a>) + (zhere-<a class="code" href="omgNeumann__2spheres_8C.html#a3">c_z</a>)*(zhere-<a class="code" href="omgNeumann__2spheres_8C.html#a3">c_z</a>) );
00237           
00238           <span class="keywordtype">double</span> currDiff;
00239           <span class="keywordflow">if</span> (rhere&lt;inneR || rhere&gt;outeR)
00240             <span class="keywordflow">continue</span>; <span class="comment">// solution should be zero here, don't account for error</span>
00241           <span class="keywordflow">else</span>
00242             currDiff = fabs ( solArray[indices[i]] - sin(<a class="code" href="omgNeumann__2spheres_8C.html#a0">w</a>*M_PI*(rhere-<a class="code" href="omgNeumann__2spheres_8C.html#a4">inneR</a>)/l)/rhere );
00243           
00244           <span class="keywordflow">if</span> (maxDiff &lt; currDiff)
00245             maxDiff=currDiff;
00246         }
00247     }  
00248   }
00249   da-&gt;<a class="code" href="classot_1_1DA.html#z35_13">vecRestoreBuffer</a>(sol,solArray,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">true</span>,1); 
00250 
00251   <span class="keywordflow">if</span> (!rank)
00252   {
00253     <span class="keywordtype">double</span> gMaxDiff;
00254     par::Mpi_Reduce&lt;double&gt;(&amp;maxDiff, &amp;gMaxDiff, 1, MPI_MAX, 0, MPI_COMM_WORLD);  
00255     std::cout&lt;&lt;<span class="stringliteral">"Maximum difference: "</span>&lt;&lt;gMaxDiff&lt;&lt;std::endl;
00256   }
00257   <span class="keywordflow">else</span> {
00258     par::Mpi_Reduce&lt;double&gt;(&amp;maxDiff, &amp;maxDiff, 1, MPI_MAX, 0, MPI_COMM_WORLD);  
00259   }
00260  
00261   <span class="comment">// destroy multigrid context; this destroys the solution as well </span>
00262   <a class="code" href="namespaceot.html#a94">DAMGDestroy</a>(damg);
00263   
00264   <a class="code" href="namespaceot.html#a93">ot::DAMG_Finalize</a>();
00265   PetscFinalize();
00266   <span class="keywordflow">return</span> 0;
00267 }
00268 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 10 11:31:25 2008 for DENDRO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
