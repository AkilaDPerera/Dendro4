<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DENDRO: /export/home/ilashuk3/Dendro/examples/src/backend/omgNeumann.C File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_daf6f5b00748c52b92c6b2e1ffe15259.html">examples</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_94477dbcc013eeed78f5fae51fb52372.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_b37aabc40b509e09be7f9fb38157174b.html">backend</a></div>
<h1>omgNeumann.C File Reference</h1><code>#include &lt;mpi.h&gt;</code><br>
<code>#include &lt;cstdio&gt;</code><br>
<code>#include &quot;<a class="el" href="oda_8h-source.html">oda.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="omg_8h-source.html">omg.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="Point_8h-source.html">Point.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="parUtils_8h-source.html">parUtils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="octUtils_8h-source.html">octUtils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="TreeNode_8h-source.html">TreeNode.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="handleStencils_8h-source.html">handleStencils.h</a>&quot;</code><br>
<code>#include &lt;cstdlib&gt;</code><br>
<code>#include &quot;<a class="el" href="sys_8h-source.html">sys.h</a>&quot;</code><br>
<code>#include &lt;sstream&gt;</code><br>
<code>#include &quot;<a class="el" href="omgNeumann_8h-source.html">omgNeumann.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="dendro_8h-source.html">dendro.h</a>&quot;</code><br>

<p>
<a href="omgNeumann_8C-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structJac2MFreeData.html">Jac2MFreeData</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#ce453d18c8bc6c8899abbb05e4dc797d">ASSIGN_MAT_PROP_FINE_TO_COARSE_ELEM_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#263be79a899053211947b3c25f6b7743">BUILD_FULL_JAC_TYPE2_BLOCK</a>(B)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#6e5ab8ad59857f9fad46fbd080648373">CHK_AND_SCATTER_FINE_TO_COARSE_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#ace0d353d55b39472940aaf478b925f4">FINE_TO_COARSE_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#5d60cec1a648065e3a898c12592f396a">JAC_TYPE2_DIAG_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#b2698e43c2320423e5f6cb64a6d374fd">JAC_TYPE2_ELEM_DIAG_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#181d2cc064efd5f8c8f0d7a1cb3304e9">JAC_TYPE2_ELEM_MULT_BLOCK</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#4d91def6d7e0e4be4d68ed6f9422c78b">JAC_TYPE2_MULT_BLOCK</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#adbb37b3659a6936835ba6201007e4a7">CalculateCenters</a> (<a class="el" href="classot_1_1DA.html">ot::DA</a> *da, std::vector&lt; double &gt; &amp;centers)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#9e872d679a02c2a316489874821f74fe">ComputeJacobian2</a> (<a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> damg, Mat J, Mat B)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#2c0a2052e1305c2de3261f31acbf77b4">ComputeRHS_omgNeumann</a> (<a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> damg, Vec in)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#c395c44fa5e32f5a77da32e89ea18bb3">CreateJacobian2</a> (<a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> damg, Mat *jac)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#aa27d7c7edc71dd25af19dd9ae1038d2">DestroyUserContexts</a> (<a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *damg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#61e2aee4ecfb74432ae361b133dd05ed">getActiveStateAndActiveCommForKSP_Shell_Jac2or3</a> (Mat mat, bool &amp;activeState, MPI_Comm &amp;activeComm)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#64c2fd280782e5fc241589ffb09f273d">getPrivateMatricesForKSP_Shell_Jac2</a> (Mat mat, Mat *AmatPrivate, Mat *PmatPrivate, MatStructure *pFlag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#ca6c7584b68efe6aaaa7905651886050">Jacobian2MatDestroy</a> (Mat J)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#89a3116f175cabef6552427bab4f668f">Jacobian2MatGetDiagonal</a> (Mat J, Vec diag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#aaf9e72b3660da1dc3738ecef3c36308">Jacobian2MatMult</a> (Mat J, Vec in, Vec out)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">PetscErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#aff5fd4f1d4aa78034b8b433708e4c76">Jacobian2ShellMatMult</a> (Mat J, Vec in, Vec out)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#e05daa41cbb1eea3d79831ed0770054a">SetPDECoefFromPts</a> (<a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *damg, const std::vector&lt; double &gt; &amp;centers, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#e88edf88787f4825c7b91f874637f6b3">solve_neumann</a> (std::vector&lt; double &gt; &amp;pts, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), void(*CalcRHS)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), int numMultigridLevels, Vec &amp;sol, <a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&amp;damg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function calculates the approximate solution to the scalar equation -div(alpha*grad u) + beta * u = f in the unit cube subject to homogeneous Neumann boundary conditions.  <a href="#e88edf88787f4825c7b91f874637f6b3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#060931b6a9ff3c14976be7a2d815da72">solve_neumann_oct</a> (std::vector&lt; <a class="el" href="classot_1_1TreeNode.html">ot::TreeNode</a> &gt; &amp;octs, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), void(*CalcRHS)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), int numMultigridLevels, Vec &amp;sol, <a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&amp;damg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function calculates the approximate solution to the scalar equation -div(alpha*grad u) + beta * u = f in the unit cube subject to homogeneous Neumann boundary conditions.  <a href="#060931b6a9ff3c14976be7a2d815da72"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static std::vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#2f1b7a5d2322ec124fb184bea64a3e75">force_values</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double ****&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#773443a18514abe026e6ad890d3c2645">LaplacianType2Stencil</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double ****&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#cc1f80163d7afcc9c0a30513b9505d8f">MassType2Stencil</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double ***&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="omgNeumann_8C.html#c50a3a365b137b7753128a1691c895ce">RHSType2Stencil</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<dl compact><dt><b>Author:</b></dt><dd>Ilya Lashuk, <a href="mailto:ilya.lashuk@gmail.com">ilya.lashuk@gmail.com</a> </dd></dl>

<p>
Definition in file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="ce453d18c8bc6c8899abbb05e4dc797d"></a><!-- doxytag: member="omgNeumann.C::ASSIGN_MAT_PROP_FINE_TO_COARSE_ELEM_BLOCK" ref="ce453d18c8bc6c8899abbb05e4dc797d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ASSIGN_MAT_PROP_FINE_TO_COARSE_ELEM_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00073">73</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="263be79a899053211947b3c25f6b7743"></a><!-- doxytag: member="omgNeumann.C::BUILD_FULL_JAC_TYPE2_BLOCK" ref="263be79a899053211947b3c25f6b7743" args="(B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUILD_FULL_JAC_TYPE2_BLOCK          </td>
          <td>(</td>
          <td class="paramtype">B&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00560">560</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="6e5ab8ad59857f9fad46fbd080648373"></a><!-- doxytag: member="omgNeumann.C::CHK_AND_SCATTER_FINE_TO_COARSE_BLOCK" ref="6e5ab8ad59857f9fad46fbd080648373" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHK_AND_SCATTER_FINE_TO_COARSE_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00040">40</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="ace0d353d55b39472940aaf478b925f4"></a><!-- doxytag: member="omgNeumann.C::FINE_TO_COARSE_BLOCK" ref="ace0d353d55b39472940aaf478b925f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FINE_TO_COARSE_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00115">115</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="5d60cec1a648065e3a898c12592f396a"></a><!-- doxytag: member="omgNeumann.C::JAC_TYPE2_DIAG_BLOCK" ref="5d60cec1a648065e3a898c12592f396a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JAC_TYPE2_DIAG_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{\
  <a class="code" href="classot_1_1DA.html">ot::DA</a>* da = damg-&gt;da;\
  <a class="code" href="omg_8C.html#7d112f1b58b5845d7cc877071237f48e">iC</a>(VecZeroEntries(diag));\
  <span class="keywordtype">double</span> *matPropArr;\
  <span class="comment">/*Elem,Ghost,Read-only,1 dof*/</span>\
  da-&gt;<a class="code" href="classot_1_1DA.html#b3795ed86c2a14e75790d626426637cf">vecGetBuffer</a>&lt;<span class="keywordtype">double</span>&gt;(*(data-&gt;matProp),matPropArr,<span class="keyword">true</span>,<span class="keyword">true</span>,<span class="keyword">true</span>,2);\
  PetscScalar *diagArr;\
  <span class="comment">/*Nodal,Non-Ghosted,Write,1 dof*/</span>\
  da-&gt;<a class="code" href="classot_1_1DA.html#b3795ed86c2a14e75790d626426637cf">vecGetBuffer</a>(diag,diagArr,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,1);\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxD;\
  <span class="keywordtype">double</span> hFac;\
  <span class="keywordflow">if</span>(da-&gt;<a class="code" href="classot_1_1DA.html#7e8787a2d7aad0c7ae2bdb8377b53843">iAmActive</a>()) {\
    maxD = (da-&gt;<a class="code" href="classot_1_1DA.html#f82f97af59d18d222fadc2d1fe4e8357">getMaxDepth</a>());\
    hFac = 1.0/((double)(1u &lt;&lt; (maxD-1)));\
    <span class="comment">/*Loop through All Elements including ghosted*/</span>\
    <span class="keywordflow">for</span>(da-&gt;<a class="code" href="classot_1_1DA.html#b6cc314d2bca785a8b02844731b2fb50">init</a>&lt;<a class="code" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#91a567428851441c716250e60c93d065">curr</a>() &lt; da-&gt;<a class="code" href="classot_1_1DA.html#33f979f3370f310e7c17bd9f3ae94a9b">end</a>&lt;<a class="code" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>&gt;(); da-&gt;<a class="code" href="classot_1_1DA.html#a2e27e8b838e8ad95e5f898b25912317">next</a>&lt;<a class="code" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>&gt;()) {\
      <a class="code" href="omgJac_8C.html#b2698e43c2320423e5f6cb64a6d374fd">JAC_TYPE2_ELEM_DIAG_BLOCK</a>\
    } <span class="comment">/*end i*/</span>\
  } <span class="comment">/*end if active*/</span>\
  da-&gt;<a class="code" href="classot_1_1DA.html#27cec1eec5bec26ae265fd10e40692c1">vecRestoreBuffer</a>&lt;<span class="keywordtype">double</span>&gt;(*(data-&gt;matProp),matPropArr,<span class="keyword">true</span>,<span class="keyword">true</span>,<span class="keyword">true</span>,2);\
  da-&gt;<a class="code" href="classot_1_1DA.html#27cec1eec5bec26ae265fd10e40692c1">vecRestoreBuffer</a>(diag,diagArr,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,1);\
  PetscLogFlops(44*(da-&gt;<a class="code" href="classot_1_1DA.html#38ad441ad3ad2da146c79b9b24d0502a">getGhostedElementSize</a>()));\
}
</pre></div>
<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00416">416</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="b2698e43c2320423e5f6cb64a6d374fd"></a><!-- doxytag: member="omgNeumann.C::JAC_TYPE2_ELEM_DIAG_BLOCK" ref="b2698e43c2320423e5f6cb64a6d374fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JAC_TYPE2_ELEM_DIAG_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx = da-&gt;curr();\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lev = da-&gt;getLevel(idx);\
  <span class="keywordtype">double</span> h = hFac*(1u &lt;&lt; (maxD - lev));\
  <span class="keywordtype">double</span> matP1 = matPropArr[2*idx];\
  <span class="keywordtype">double</span> matP2 = matPropArr[2*idx+1];\
  <span class="keywordtype">double</span> fac1 = matP1*h/2.0;\
  <span class="keywordtype">double</span> fac2 = matP2*h*h*h/8.0;\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indices[8];\
  da-&gt;getNodeIndices(indices);\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> childNum = da-&gt;getChildNumber();\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hnMask = da-&gt;getHangingNodeIndex(idx);\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elemType = 0;\
  <a class="code" href="odaUtils_8h.html#94839c609019faeb9fd24fe0a66270cd">GET_ETYPE_BLOCK</a>(elemType,hnMask,childNum)\
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; 8; k++) {\
    diagArr[indices[k]] +=  ((fac1*(<a class="code" href="elasticityJac_8C.html#773443a18514abe026e6ad890d3c2645">LaplacianType2Stencil</a>[childNum][elemType][k][k])) +\
        (fac2*(<a class="code" href="odaJac_8C.html#cc1f80163d7afcc9c0a30513b9505d8f">MassType2Stencil</a>[childNum][elemType][k][k])));\
  } <span class="comment">/*end k*/</span>\
}
</pre></div>
<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00396">396</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="181d2cc064efd5f8c8f0d7a1cb3304e9"></a><!-- doxytag: member="omgNeumann.C::JAC_TYPE2_ELEM_MULT_BLOCK" ref="181d2cc064efd5f8c8f0d7a1cb3304e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JAC_TYPE2_ELEM_MULT_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx = da-&gt;curr();\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lev = da-&gt;getLevel(idx);\
  <span class="keywordtype">double</span> h = hFac*(1u &lt;&lt; (maxD - lev));\
  <span class="keywordtype">double</span> matP1 = matPropArr[2*idx];\
  <span class="keywordtype">double</span> matP2 = matPropArr[2*idx+1];\
  <span class="keywordtype">double</span> fac1 = matP1*h/2.0;\
  <span class="keywordtype">double</span> fac2 = matP2*h*h*h/8.0;\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indices[8];\
  da-&gt;getNodeIndices(indices);\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> childNum = da-&gt;getChildNumber();\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hnMask = da-&gt;getHangingNodeIndex(idx);\
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elemType = 0;\
  <a class="code" href="odaUtils_8h.html#94839c609019faeb9fd24fe0a66270cd">GET_ETYPE_BLOCK</a>(elemType,hnMask,childNum)\
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0;k &lt; 8;k++) {\
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;8;j++) {\
      outArr[indices[k]] +=  (((fac1*(<a class="code" href="elasticityJac_8C.html#773443a18514abe026e6ad890d3c2645">LaplacianType2Stencil</a>[childNum][elemType][k][j])) +\
            (fac2*(<a class="code" href="odaJac_8C.html#cc1f80163d7afcc9c0a30513b9505d8f">MassType2Stencil</a>[childNum][elemType][k][j])))*inArr[indices[j]]);\
    }<span class="comment">/*end for j*/</span>\
  }<span class="comment">/*end for k*/</span>\
}
</pre></div>
<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00468">468</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="4d91def6d7e0e4be4d68ed6f9422c78b"></a><!-- doxytag: member="omgNeumann.C::JAC_TYPE2_MULT_BLOCK" ref="4d91def6d7e0e4be4d68ed6f9422c78b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JAC_TYPE2_MULT_BLOCK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00491">491</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="adbb37b3659a6936835ba6201007e4a7"></a><!-- doxytag: member="omgNeumann.C::CalculateCenters" ref="adbb37b3659a6936835ba6201007e4a7" args="(ot::DA *da, std::vector&lt; double &gt; &amp;centers)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void CalculateCenters           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classot_1_1DA.html">ot::DA</a> *&nbsp;</td>
          <td class="paramname"> <em>da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>centers</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00788">788</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>, <a class="el" href="oda_8C-source.html#l00461">ot::DA::createVector()</a>, <a class="el" href="oda_8txx-source.html#l00025">ot::DA::curr()</a>, <a class="el" href="classot_1_1DA.html#33f979f3370f310e7c17bd9f3ae94a9b">ot::DA::end()</a>, <a class="el" href="oda_8txx-source.html#l00193">ot::DA::getCurrentOffset()</a>, <a class="el" href="oda_8txx-source.html#l00051">ot::DA::getLevel()</a>, <a class="el" href="oda_8txx-source.html#l00091">ot::DA::getMaxDepth()</a>, <a class="el" href="oda_8txx-source.html#l00165">ot::DA::iAmActive()</a>, <a class="el" href="classot_1_1DA.html#b6cc314d2bca785a8b02844731b2fb50">ot::DA::init()</a>, <a class="el" href="classot_1_1DA.html#a2e27e8b838e8ad95e5f898b25912317">ot::DA::next()</a>, <a class="el" href="Point_8h-source.html#l00055">Point::xint()</a>, <a class="el" href="Point_8h-source.html#l00056">Point::yint()</a>, and <a class="el" href="Point_8h-source.html#l00057">Point::zint()</a>.
<p>
Referenced by <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="9e872d679a02c2a316489874821f74fe"></a><!-- doxytag: member="omgNeumann.C::ComputeJacobian2" ref="9e872d679a02c2a316489874821f74fe" args="(ot::DAMG damg, Mat J, Mat B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ComputeJacobian2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a>&nbsp;</td>
          <td class="paramname"> <em>damg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>B</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00616">616</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omgJac_8C-source.html#l01803">BUILD_FULL_JAC_TYPE2_BLOCK</a>, <a class="el" href="omgJac_8h-source.html#l00016">Jac2MFreeData::Jmat_private</a>, and <a class="el" href="omg_8h-source.html#l00445">ot::_p_DAMG::user</a>.
<p>
Referenced by <a class="el" href="checkError_8C-source.html#l00048">main()</a>, <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="2c0a2052e1305c2de3261f31acbf77b4"></a><!-- doxytag: member="omgNeumann.C::ComputeRHS_omgNeumann" ref="2c0a2052e1305c2de3261f31acbf77b4" args="(ot::DAMG damg, Vec in)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ComputeRHS_omgNeumann           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a>&nbsp;</td>
          <td class="paramname"> <em>damg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>in</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00749">749</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>, <a class="el" href="oda_8txx-source.html#l00025">ot::DA::curr()</a>, <a class="el" href="omg_8h-source.html#l00421">ot::_p_DAMG::da</a>, <a class="el" href="classot_1_1DA.html#33f979f3370f310e7c17bd9f3ae94a9b">ot::DA::end()</a>, <a class="el" href="omgNeumann_8C-source.html#l00030">force_values</a>, <a class="el" href="odaUtils_8h-source.html#l00334">GET_ETYPE_BLOCK</a>, <a class="el" href="oda_8txx-source.html#l01087">ot::DA::getChildNumber()</a>, <a class="el" href="oda_8C-source.html#l00784">ot::DA::getHangingNodeIndex()</a>, <a class="el" href="oda_8txx-source.html#l00051">ot::DA::getLevel()</a>, <a class="el" href="oda_8txx-source.html#l01111">ot::DA::getNodeIndices()</a>, <a class="el" href="oda_8txx-source.html#l00165">ot::DA::iAmActive()</a>, <a class="el" href="classot_1_1DA.html#b6cc314d2bca785a8b02844731b2fb50">ot::DA::init()</a>, <a class="el" href="classot_1_1DA.html#a2e27e8b838e8ad95e5f898b25912317">ot::DA::next()</a>, <a class="el" href="omgNeumann_8C-source.html#l00029">RHSType2Stencil</a>, <a class="el" href="oda_8C-source.html#l00523">ot::DA::vecGetBuffer()</a>, and <a class="el" href="oda_8C-source.html#l00651">ot::DA::vecRestoreBuffer()</a>.
<p>
Referenced by <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="c395c44fa5e32f5a77da32e89ea18bb3"></a><!-- doxytag: member="omgNeumann.C::CreateJacobian2" ref="c395c44fa5e32f5a77da32e89ea18bb3" args="(ot::DAMG damg, Mat *jac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CreateJacobian2           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a>&nbsp;</td>
          <td class="paramname"> <em>damg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat *&nbsp;</td>
          <td class="paramname"> <em>jac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00643">643</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omg_8h-source.html#l00436">ot::_p_DAMG::comm</a>, <a class="el" href="oda_8txx-source.html#l00083">ot::DA::computedLocalToGlobal()</a>, <a class="el" href="oda_8C-source.html#l00076">ot::DA::computeLocalToGlobalMappings()</a>, <a class="el" href="oda_8C-source.html#l00431">ot::DA::createActiveMatrix()</a>, <a class="el" href="oda_8C-source.html#l00399">ot::DA::createMatrix()</a>, <a class="el" href="omg_8h-source.html#l00421">ot::_p_DAMG::da</a>, <a class="el" href="oda_8txx-source.html#l00169">ot::DA::getComm()</a>, <a class="el" href="oda_8txx-source.html#l00173">ot::DA::getCommActive()</a>, <a class="el" href="oda_8txx-source.html#l00141">ot::DA::getNodeSize()</a>, <a class="el" href="oda_8txx-source.html#l00181">ot::DA::getNpesActive()</a>, <a class="el" href="oda_8txx-source.html#l00177">ot::DA::getNpesAll()</a>, <a class="el" href="oda_8txx-source.html#l00165">ot::DA::iAmActive()</a>, <a class="el" href="omgJac_8h-source.html#l00017">Jac2MFreeData::inTmp</a>, <a class="el" href="omgJac_8C-source.html#l01586">Jacobian2MatDestroy()</a>, <a class="el" href="omgJac_8C-source.html#l01640">Jacobian2MatGetDiagonal()</a>, <a class="el" href="omgJac_8C-source.html#l01775">Jacobian2MatMult()</a>, <a class="el" href="omgJac_8C-source.html#l01164">Jacobian2ShellMatMult()</a>, <a class="el" href="omgJac_8h-source.html#l00016">Jac2MFreeData::Jmat_private</a>, <a class="el" href="omg_8h-source.html#l00434">ot::_p_DAMG::nlevels</a>, <a class="el" href="omgJac_8h-source.html#l00018">Jac2MFreeData::outTmp</a>, <a class="el" href="omg_8h-source.html#l00435">ot::_p_DAMG::totalLevels</a>, and <a class="el" href="omg_8h-source.html#l00445">ot::_p_DAMG::user</a>.
<p>
Referenced by <a class="el" href="checkError_8C-source.html#l00048">main()</a>, <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="aa27d7c7edc71dd25af19dd9ae1038d2"></a><!-- doxytag: member="omgNeumann.C::DestroyUserContexts" ref="aa27d7c7edc71dd25af19dd9ae1038d2" args="(ot::DAMG *damg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DestroyUserContexts           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&nbsp;</td>
          <td class="paramname"> <em>damg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00300">300</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omg_8h-source.html#l00434">ot::_p_DAMG::nlevels</a>.
<p>
Referenced by <a class="el" href="checkError_8C-source.html#l00048">main()</a>, <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="61e2aee4ecfb74432ae361b133dd05ed"></a><!-- doxytag: member="omgNeumann.C::getActiveStateAndActiveCommForKSP_Shell_Jac2or3" ref="61e2aee4ecfb74432ae361b133dd05ed" args="(Mat mat, bool &amp;activeState, MPI_Comm &amp;activeComm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getActiveStateAndActiveCommForKSP_Shell_Jac2or3           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>activeState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm &amp;&nbsp;</td>
          <td class="paramname"> <em>activeComm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00357">357</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="oda_8txx-source.html#l00173">ot::DA::getCommActive()</a>, and <a class="el" href="oda_8txx-source.html#l00165">ot::DA::iAmActive()</a>.
</div>
</div><p>
<a class="anchor" name="64c2fd280782e5fc241589ffb09f273d"></a><!-- doxytag: member="omgNeumann.C::getPrivateMatricesForKSP_Shell_Jac2" ref="64c2fd280782e5fc241589ffb09f273d" args="(Mat mat, Mat *AmatPrivate, Mat *PmatPrivate, MatStructure *pFlag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getPrivateMatricesForKSP_Shell_Jac2           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat *&nbsp;</td>
          <td class="paramname"> <em>AmatPrivate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat *&nbsp;</td>
          <td class="paramname"> <em>PmatPrivate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatStructure *&nbsp;</td>
          <td class="paramname"> <em>pFlag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00370">370</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omgJac_8h-source.html#l00016">Jac2MFreeData::Jmat_private</a>.
</div>
</div><p>
<a class="anchor" name="ca6c7584b68efe6aaaa7905651886050"></a><!-- doxytag: member="omgNeumann.C::Jacobian2MatDestroy" ref="ca6c7584b68efe6aaaa7905651886050" args="(Mat J)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Jacobian2MatDestroy           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>J</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00387">387</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
Referenced by <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>.
</div>
</div><p>
<a class="anchor" name="89a3116f175cabef6552427bab4f668f"></a><!-- doxytag: member="omgNeumann.C::Jacobian2MatGetDiagonal" ref="89a3116f175cabef6552427bab4f668f" args="(Mat J, Vec diag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Jacobian2MatGetDiagonal           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>diag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00442">442</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omg_8C-source.html#l00020">iC</a>, <a class="el" href="omgJac_8h-source.html#l00015">Jac2MFreeData::isFinestLevel</a>, and <a class="el" href="omgJac_8C-source.html#l01614">JAC_TYPE2_DIAG_BLOCK</a>.
<p>
Referenced by <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>.
</div>
</div><p>
<a class="anchor" name="aaf9e72b3660da1dc3738ecef3c36308"></a><!-- doxytag: member="omgNeumann.C::Jacobian2MatMult" ref="aaf9e72b3660da1dc3738ecef3c36308" args="(Mat J, Vec in, Vec out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Jacobian2MatMult           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00533">533</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omg_8C-source.html#l00020">iC</a>, <a class="el" href="omgJac_8h-source.html#l00015">Jac2MFreeData::isFinestLevel</a>, and <a class="el" href="omgJac_8C-source.html#l01687">JAC_TYPE2_MULT_BLOCK</a>.
<p>
Referenced by <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>.
</div>
</div><p>
<a class="anchor" name="aff5fd4f1d4aa78034b8b433708e4c76"></a><!-- doxytag: member="omgNeumann.C::Jacobian2ShellMatMult" ref="aff5fd4f1d4aa78034b8b433708e4c76" args="(Mat J, Vec in, Vec out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Jacobian2ShellMatMult           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&nbsp;</td>
          <td class="paramname"> <em>out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00324">324</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="omgJac_8h-source.html#l00017">Jac2MFreeData::inTmp</a>, <a class="el" href="omgJac_8h-source.html#l00016">Jac2MFreeData::Jmat_private</a>, and <a class="el" href="omgJac_8h-source.html#l00018">Jac2MFreeData::outTmp</a>.
<p>
Referenced by <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>.
</div>
</div><p>
<a class="anchor" name="e05daa41cbb1eea3d79831ed0770054a"></a><!-- doxytag: member="omgNeumann.C::SetPDECoefFromPts" ref="e05daa41cbb1eea3d79831ed0770054a" args="(ot::DAMG *damg, const std::vector&lt; double &gt; &amp;centers, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetPDECoefFromPts           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&nbsp;</td>
          <td class="paramname"> <em>damg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>centers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values)&nbsp;</td>
          <td class="paramname"> <em>CalcCoef</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00188">188</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="namespaceot_1_1DA__FLAGS.html#4acf71b75dc074bedc566cb7e5de56c344bf15e056082bc8f55633715ad00279">ot::DA_FLAGS::ALL</a>, <a class="el" href="matProp_8C-source.html#l00234">CHK_AND_SCATTER_FINE_TO_COARSE_BLOCK</a>, <a class="el" href="oda_8C-source.html#l00461">ot::DA::createVector()</a>, <a class="el" href="oda_8txx-source.html#l00025">ot::DA::curr()</a>, <a class="el" href="omg_8h-source.html#l00421">ot::_p_DAMG::da</a>, <a class="el" href="classot_1_1DA.html#33f979f3370f310e7c17bd9f3ae94a9b">ot::DA::end()</a>, <a class="el" href="matProp_8C-source.html#l00326">FINE_TO_COARSE_BLOCK</a>, <a class="el" href="oda_8txx-source.html#l00173">ot::DA::getCommActive()</a>, <a class="el" href="oda_8txx-source.html#l00165">ot::DA::iAmActive()</a>, <a class="el" href="classot_1_1DA.html#b6cc314d2bca785a8b02844731b2fb50">ot::DA::init()</a>, <a class="el" href="classot_1_1DA.html#a2e27e8b838e8ad95e5f898b25912317">ot::DA::next()</a>, <a class="el" href="omg_8h-source.html#l00434">ot::_p_DAMG::nlevels</a>, <a class="el" href="omg_8h-source.html#l00445">ot::_p_DAMG::user</a>, <a class="el" href="oda_8C-source.html#l00523">ot::DA::vecGetBuffer()</a>, and <a class="el" href="oda_8C-source.html#l00651">ot::DA::vecRestoreBuffer()</a>.
<p>
Referenced by <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="e88edf88787f4825c7b91f874637f6b3"></a><!-- doxytag: member="omgNeumann.C::solve_neumann" ref="e88edf88787f4825c7b91f874637f6b3" args="(std::vector&lt; double &gt; &amp;pts, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), void(*CalcRHS)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), int numMultigridLevels, Vec &amp;sol, ot::DAMG *&amp;damg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solve_neumann           </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values)&nbsp;</td>
          <td class="paramname"> <em>CalcCoef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values)&nbsp;</td>
          <td class="paramname"> <em>CalcRHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMultigridLevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec &amp;&nbsp;</td>
          <td class="paramname"> <em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>damg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function calculates the approximate solution to the scalar equation -div(alpha*grad u) + beta * u = f in the unit cube subject to homogeneous Neumann boundary conditions. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Ilya Lashuk </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pts</em>&nbsp;</td><td>coordinates of points. Each point must be in [0,1)^3. Octree will be built based on these points. No octant of the octree will contain more than 1 point. Coordinates are stored in a sequence X1, Y1, Z1, X2, Y2, Z2, ... </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CalcCoef</em>&nbsp;</td><td>function pointer to function which will calculate the values of "alpha" and "beta" (see the equation above) for the center of each octant. Coordinates of all centers are provided in the first parameter (layout is X1,Y1,Z1,X2,Y2,Z2,...). Values should be returned in second parameter. The following layout should be used: alpha1,beta1,alpha2,beta2,.... Caller will set the array size for the second parameter (to be equal to 2/3 size of the first parameter). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CalcRHS</em>&nbsp;</td><td>function pointer to function which will calculate the value of "f" (see the equation above) for the center of each octant. Coordinates of all centers are provided in the first parameter (layout is the same as above). Values of "f" should be returned in second parameter. Caller will set the array size for the second parameter (to be equal to 1/3 size of the first parameter). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numMultigridLevels</em>&nbsp;</td><td>desired number of multigrid levels. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sol</em>&nbsp;</td><td>in this parameter the solution is returned. This object is automatically destroyed when the "damg" object (see next parameter) is destroyed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>damg</em>&nbsp;</td><td>in this parameter the multigrid context (used to calculate solution) is returned. User must destroy this object when no longer needed by calling DAMGDestroy </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00832">832</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="Balance_8C-source.html#l00031">ot::balanceOctree()</a>, <a class="el" href="omgNeumann_8C-source.html#l00788">CalculateCenters()</a>, <a class="el" href="omgJac_8C-source.html#l01860">ComputeJacobian2()</a>, <a class="el" href="omgNeumann_8C-source.html#l00749">ComputeRHS_omgNeumann()</a>, <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00754">createLmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00519">createMmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00988">createRHSType2()</a>, <a class="el" href="omg_8C-source.html#l01300">ot::DAMGCreateAndSetDA()</a>, <a class="el" href="omg_8h-source.html#l00546">DAMGGetx</a>, <a class="el" href="omg_8C-source.html#l00777">ot::DAMGSetKSP()</a>, <a class="el" href="omg_8C-source.html#l01115">ot::DAMGSolve()</a>, <a class="el" href="dendro_8h-source.html#l00015">DendroIntL</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01227">destroyLmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01247">destroyMmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01209">destroyRHSType2()</a>, <a class="el" href="matProp_8C-source.html#l00999">DestroyUserContexts()</a>, <a class="el" href="omgNeumann_8C-source.html#l00030">force_values</a>, <a class="el" href="checkError_8C-source.html#l00043">LaplacianType2Stencil</a>, <a class="el" href="checkError_8C-source.html#l00045">MassType2Stencil</a>, <a class="el" href="Construct_8C-source.html#l00725">ot::points2Octree()</a>, <a class="el" href="omgNeumann_8C-source.html#l00029">RHSType2Stencil</a>, and <a class="el" href="omgNeumann_8C-source.html#l00188">SetPDECoefFromPts()</a>.
<p>
Referenced by <a class="el" href="omgNeumann__ex1_8C-source.html#l00044">main()</a>.
</div>
</div><p>
<a class="anchor" name="060931b6a9ff3c14976be7a2d815da72"></a><!-- doxytag: member="omgNeumann.C::solve_neumann_oct" ref="060931b6a9ff3c14976be7a2d815da72" args="(std::vector&lt; ot::TreeNode &gt; &amp;octs, void(*CalcCoef)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), void(*CalcRHS)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values), int numMultigridLevels, Vec &amp;sol, ot::DAMG *&amp;damg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solve_neumann_oct           </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classot_1_1TreeNode.html">ot::TreeNode</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>octs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values)&nbsp;</td>
          <td class="paramname"> <em>CalcCoef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const std::vector&lt; double &gt; &amp;pts, std::vector&lt; double &gt; &amp;values)&nbsp;</td>
          <td class="paramname"> <em>CalcRHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numMultigridLevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec &amp;&nbsp;</td>
          <td class="paramname"> <em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structot_1_1__p__DAMG.html">ot::DAMG</a> *&amp;&nbsp;</td>
          <td class="paramname"> <em>damg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function calculates the approximate solution to the scalar equation -div(alpha*grad u) + beta * u = f in the unit cube subject to homogeneous Neumann boundary conditions. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Ilya Lashuk </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>octs</em>&nbsp;</td><td>sequence of octants. Octree will be built by completing this sequence of octants. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CalcCoef</em>&nbsp;</td><td>function pointer to function which will calculate the values of "alpha" and "beta" (see the equation above) for the center of each octant. Coordinates of all centers are provided in the first parameter (layout is X1,Y1,Z1,X2,Y2,Z2,...). Values should be returned in second parameter. The following layout should be used: alpha1,beta1,alpha2,beta2,.... Caller will set the array size for the second parameter (to be equal to 2/3 size of the first parameter). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CalcRHS</em>&nbsp;</td><td>function pointer to function which will calculate the value of "f" (see the equation above) for the center of each octant. Coordinates of all centers are provided in the first parameter (layout is the same as above). Values of "f" should be returned in second parameter. Caller will set the array size for the second parameter (to be equal to 1/3 size of the first parameter). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numMultigridLevels</em>&nbsp;</td><td>desired number of multigrid levels. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sol</em>&nbsp;</td><td>in this parameter the solution is returned. This object is automatically destroyed when the "damg" object (see next parameter) is destroyed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>damg</em>&nbsp;</td><td>in this parameter the multigrid context (used to calculate solution) is returned. User must destroy this object when no longer needed by calling DAMGDestroy </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00949">949</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
References <a class="el" href="Balance_8C-source.html#l00031">ot::balanceOctree()</a>, <a class="el" href="omgNeumann_8C-source.html#l00788">CalculateCenters()</a>, <a class="el" href="Construct_8C-source.html#l00512">ot::completeOctree()</a>, <a class="el" href="omgJac_8C-source.html#l01860">ComputeJacobian2()</a>, <a class="el" href="omgNeumann_8C-source.html#l00749">ComputeRHS_omgNeumann()</a>, <a class="el" href="omgJac_8C-source.html#l01482">CreateJacobian2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00754">createLmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00519">createMmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l00988">createRHSType2()</a>, <a class="el" href="omg_8C-source.html#l01300">ot::DAMGCreateAndSetDA()</a>, <a class="el" href="omg_8h-source.html#l00546">DAMGGetx</a>, <a class="el" href="omg_8C-source.html#l00777">ot::DAMGSetKSP()</a>, <a class="el" href="omg_8C-source.html#l01115">ot::DAMGSolve()</a>, <a class="el" href="dendro_8h-source.html#l00015">DendroIntL</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01227">destroyLmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01247">destroyMmatType2()</a>, <a class="el" href="handleType2Stencils_8C-source.html#l01209">destroyRHSType2()</a>, <a class="el" href="matProp_8C-source.html#l00999">DestroyUserContexts()</a>, <a class="el" href="omgNeumann_8C-source.html#l00030">force_values</a>, <a class="el" href="checkError_8C-source.html#l00043">LaplacianType2Stencil</a>, <a class="el" href="checkError_8C-source.html#l00045">MassType2Stencil</a>, <a class="el" href="omgNeumann_8C-source.html#l00029">RHSType2Stencil</a>, and <a class="el" href="omgNeumann_8C-source.html#l00188">SetPDECoefFromPts()</a>.
<p>
Referenced by <a class="el" href="omgNeumann__2spheres_8C-source.html#l00086">main()</a>.
</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="2f1b7a5d2322ec124fb184bea64a3e75"></a><!-- doxytag: member="omgNeumann.C::force_values" ref="2f1b7a5d2322ec124fb184bea64a3e75" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; <a class="el" href="omgNeumann_8C.html#2f1b7a5d2322ec124fb184bea64a3e75">force_values</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00030">30</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
Referenced by <a class="el" href="omgNeumann_8C-source.html#l00749">ComputeRHS_omgNeumann()</a>, <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<a class="anchor" name="773443a18514abe026e6ad890d3c2645"></a><!-- doxytag: member="omgNeumann.C::LaplacianType2Stencil" ref="773443a18514abe026e6ad890d3c2645" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double**** <a class="el" href="tstRegularMg_8C.html#773443a18514abe026e6ad890d3c2645">LaplacianType2Stencil</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00027">27</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="cc1f80163d7afcc9c0a30513b9505d8f"></a><!-- doxytag: member="omgNeumann.C::MassType2Stencil" ref="cc1f80163d7afcc9c0a30513b9505d8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double**** <a class="el" href="tstRegularMg_8C.html#cc1f80163d7afcc9c0a30513b9505d8f">MassType2Stencil</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00028">28</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
</div>
</div><p>
<a class="anchor" name="c50a3a365b137b7753128a1691c895ce"></a><!-- doxytag: member="omgNeumann.C::RHSType2Stencil" ref="c50a3a365b137b7753128a1691c895ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double*** <a class="el" href="omgNeumann_8C.html#c50a3a365b137b7753128a1691c895ce">RHSType2Stencil</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="omgNeumann_8C-source.html#l00029">29</a> of file <a class="el" href="omgNeumann_8C-source.html">omgNeumann.C</a>.
<p>
Referenced by <a class="el" href="omgNeumann_8C-source.html#l00749">ComputeRHS_omgNeumann()</a>, <a class="el" href="omgNeumann_8C-source.html#l00832">solve_neumann()</a>, and <a class="el" href="omgNeumann_8C-source.html#l00949">solve_neumann_oct()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Fri Mar 19 16:26:45 2010 for DENDRO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
