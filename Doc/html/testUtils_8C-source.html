<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DENDRO: /net/ac190/www-db1/grads/r/rahulss/Dendro/src/test/testUtils.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000013.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000023.html">test</a></div>
<h1>testUtils.C</h1><a href="testUtils_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00007 <span class="preprocessor">#include "<a class="code" href="TreeNode_8h.html">TreeNode.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="testUtils_8h.html">testUtils.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="parUtils_8h.html">parUtils.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="seqUtils_8h.html">seqUtils.h</a>"</span>
00011 
00012 <span class="keyword">namespace </span>ot {
<a name="l00013"></a><a class="code" href="namespaceot_1_1test.html">00013</a>   <span class="keyword">namespace </span>test {
00014 
00015     <span class="comment">//Assumes nodes is sorted and unique</span>
<a name="l00016"></a><a class="code" href="namespaceot_1_1test.html#a0">00016</a>     <span class="keywordtype">bool</span> <a class="code" href="namespaceot_1_1test.html#a0">isLinear</a>(<span class="keyword">const</span> std::vector&lt;ot::TreeNode &gt; &amp;nodes) {
00017       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; (nodes.size() -1); i++) {
00018         <span class="keywordflow">if</span>(nodes[i].isAncestor(nodes[i+1])){
00019           <span class="keywordflow">return</span> <span class="keyword">false</span>;
00020         }
00021       }
00022       <span class="keywordflow">return</span> <span class="keyword">true</span>;       
00023     }
00024 
00025 <span class="comment">//Assumes nodes is sorted and unique.</span>
<a name="l00026"></a><a class="code" href="namespaceot_1_1test.html#a1">00026</a> <span class="keywordtype">bool</span> <a class="code" href="namespaceot_1_1test.html#a1">isComplete</a>(<span class="keyword">const</span> std::vector&lt;ot::TreeNode &gt;&amp; nodes) {
00027   assert(!nodes.empty());
00028   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = nodes[0].getDim();
00029   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxDepth = nodes[0].getMaxDepth();
00030 
00031   std::vector&lt;ot::TreeNode &gt; tmp1 = nodes;
00032   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lev = maxDepth; lev &gt; 0; lev--) {
00033     <span class="comment">//1. Select all octants at lev</span>
00034     std::vector&lt;ot::TreeNode &gt; tmp2;
00035     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; tmp1.size(); i++) {
00036       <span class="keywordflow">if</span>(tmp1[i].getLevel() == lev) {
00037         tmp2.push_back(tmp1[i]);
00038       }
00039     }<span class="comment">//end for i</span>
00040 
00041     <span class="keywordflow">if</span>( (tmp2.size()%8) != 0) {
00042       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00043     }
00044 
00045     std::vector&lt;ot::TreeNode &gt; tmp3;
00046     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp2Cnt = 0;
00047     <span class="keywordflow">while</span>(tmp2Cnt &lt; tmp2.size()) {
00048       <a class="code" href="classot_1_1TreeNode.html">ot::TreeNode</a> currParent = tmp2[tmp2Cnt].getParent();
00049       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; (1 &lt;&lt; dim); i++) {
00050         assert((tmp2Cnt + i) &lt; tmp2.size()); 
00051         <span class="keywordflow">if</span>(tmp2[tmp2Cnt + i].getParent() != currParent) {
00052           <span class="keywordflow">return</span> <span class="keyword">false</span>; 
00053         }
00054       }
00055       tmp3.push_back(currParent);
00056       tmp2Cnt +=8;
00057     }<span class="comment">//end while</span>
00058 
00059     tmp2.clear();
00060 
00061     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; tmp1.size(); i++) {
00062       <span class="keywordflow">if</span>(tmp1[i].getLevel() != lev) {
00063         tmp3.push_back(tmp1[i]);
00064       }
00065     }<span class="comment">//end for i</span>
00066 
00067     <a class="code" href="Sort_8h.html#a7">std::sort</a>(tmp3.begin(),tmp3.end());
00068     tmp1 = tmp3;
00069     tmp3.clear();
00070 
00071   }<span class="comment">//end for lev</span>
00072   <span class="keywordflow">return</span> <span class="keyword">true</span>;
00073 }
00074 
<a name="l00075"></a><a class="code" href="namespaceot_1_1test.html#a2">00075</a> <span class="keywordtype">bool</span> <a class="code" href="namespaceot_1_1test.html#a2">isBalanced</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxDepth, <span class="keywordtype">char</span>*failFileName,
00076     <span class="keyword">const</span> std::vector&lt;ot::TreeNode &gt; &amp;nodes, <span class="keywordtype">bool</span> incCorn, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxLevDiff) {
00077   <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> root (dim, maxDepth);
00078   <span class="keywordflow">return</span>        <a class="code" href="namespaceot_1_1test.html#a3">isBalancedInternal</a>(dim,maxDepth,failFileName,nodes,root, incCorn, maxLevDiff);
00079 }<span class="comment">//end function</span>
00080 
<a name="l00081"></a><a class="code" href="namespaceot_1_1test.html#a3">00081</a> <span class="keywordtype">bool</span> <a class="code" href="namespaceot_1_1test.html#a3">isBalancedInternal</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxDepth,<span class="keywordtype">char</span>*failFileName,
00082     <span class="keyword">const</span>  std::vector&lt;ot::TreeNode &gt; &amp; nodes, <a class="code" href="classot_1_1TreeNode.html">ot::TreeNode</a> holder,
00083     <span class="keywordtype">bool</span> incCorn, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxLevDiff) {
00084   <span class="keywordtype">bool</span> yesBalanced = <span class="keyword">true</span>;
00085   std::vector&lt;TreeNode&gt; failedCorners;
00086   std::vector&lt;TreeNode&gt; failedEdges;
00087   std::vector&lt;TreeNode&gt; failedFaces;
00088   <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> root (dim, maxDepth);
00089   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retIdx;
00090   <span class="keywordtype">double</span> nxz = (double) nodes.size();
00091   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nodes.size(); i++) {
00092     <span class="comment">/*</span>
00093 <span class="comment">       if (!(i%100)) {</span>
00094 <span class="comment">       printf("%4.2f\r", 100.0*((double)i)/nxz);</span>
00095 <span class="comment">       }</span>
00096 <span class="comment">       */</span>
00097 
00098     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"R"&lt;&lt;NRM&lt;&lt;endl;</span>
00099     {
00100       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getRight();
00101 
00102       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00103 
00104         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00105         <span class="keywordflow">if</span>(found) {
00106           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00107           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00108           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00109             found = <span class="keyword">false</span>;
00110           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00111             <span class="comment">//Found a very big Neighbour</span>
00112             found = <span class="keyword">false</span>;
00113           }                                             
00114         }
00115         <span class="keywordflow">if</span>(!found) {
00116           yesBalanced = <span class="keyword">false</span>;
00117           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (R) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00118           failedFaces.push_back(nodes[i]);                                      
00119           <span class="keywordflow">break</span>;
00120         }
00121       }
00122 
00123     }
00124 
00125     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"L"&lt;&lt;NRM&lt;&lt;endl;</span>
00126     {
00127       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getLeft();
00128 
00129       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00130 
00131         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00132         <span class="keywordflow">if</span>(found) {
00133           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00134           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00135           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00136             found = <span class="keyword">false</span>;
00137           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00138             <span class="comment">//Found a very big Neighbour</span>
00139             found = <span class="keyword">false</span>;
00140           }                                             
00141         }
00142         <span class="keywordflow">if</span>(!found) {
00143           yesBalanced = <span class="keyword">false</span>;
00144           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (L) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00145           failedFaces.push_back(nodes[i]);                                      
00146           <span class="keywordflow">break</span>;
00147         }
00148       }
00149 
00150     }
00151 
00152 
00153     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"T"&lt;&lt;NRM&lt;&lt;endl;</span>
00154     {
00155       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTop();
00156 
00157       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00158 
00159         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00160         <span class="keywordflow">if</span>(found) {
00161           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00162           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00163           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00164             found = <span class="keyword">false</span>;
00165           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00166             <span class="comment">//Found a very big Neighbour</span>
00167             found = <span class="keyword">false</span>;
00168           }                                             
00169         }
00170         <span class="keywordflow">if</span>(!found) {
00171           yesBalanced = <span class="keyword">false</span>;
00172           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (T) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00173           failedFaces.push_back(nodes[i]);                                      
00174           <span class="keywordflow">break</span>;
00175         }
00176       }
00177     }
00178 
00179     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"Bo"&lt;&lt;NRM&lt;&lt;endl;</span>
00180     {
00181       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottom();
00182 
00183 
00184       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00185 
00186         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00187         <span class="keywordflow">if</span>(found) {
00188           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00189           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00190           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00191             found = <span class="keyword">false</span>;
00192           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00193             <span class="comment">//Found a very big Neighbour</span>
00194             found = <span class="keyword">false</span>;
00195           }                                             
00196         }
00197         <span class="keywordflow">if</span>(!found) {
00198           yesBalanced = <span class="keyword">false</span>;
00199           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (Bo) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00200           failedFaces.push_back(nodes[i]);                                      
00201           <span class="keywordflow">break</span>;
00202         }
00203       }
00204 
00205     }
00206 
00207     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"F"&lt;&lt;NRM&lt;&lt;endl;</span>
00208     {
00209       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getFront();
00210 
00211 
00212       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00213 
00214         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00215         <span class="keywordflow">if</span>(found) {
00216           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00217           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00218           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00219             found = <span class="keyword">false</span>;
00220           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00221             <span class="comment">//Found a very big Neighbour</span>
00222             found = <span class="keyword">false</span>;
00223           }                                             
00224         }
00225         <span class="keywordflow">if</span>(!found) {
00226           yesBalanced = <span class="keyword">false</span>;
00227           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (F) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00228           failedFaces.push_back(nodes[i]);                                      
00229           <span class="keywordflow">break</span>;
00230         }
00231       }
00232 
00233     }
00234 
00235     <span class="comment">// cout&lt;&lt;RED&lt;&lt;"Bk"&lt;&lt;NRM&lt;&lt;endl;</span>
00236     {
00237       <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBack();
00238 
00239 
00240       <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00241 
00242         <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00243         <span class="keywordflow">if</span>(found) {
00244           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00245           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                     
00246           <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00247             found = <span class="keyword">false</span>;
00248           }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00249             <span class="comment">//Found a very big Neighbour</span>
00250             found = <span class="keyword">false</span>;
00251           }                                             
00252         }
00253         <span class="keywordflow">if</span>(!found) {
00254           yesBalanced = <span class="keyword">false</span>;
00255           std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (Bk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00256           failedFaces.push_back(nodes[i]);                                      
00257           <span class="keywordflow">break</span>;
00258         }
00259       }
00260 
00261     }
00262 
00263     <span class="keywordflow">if</span>(dim == 3 || incCorn) {
00264       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TR"&lt;&lt;NRM&lt;&lt;endl;</span>
00265       {
00266         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopRight();
00267 
00268 
00269         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00270 
00271           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00272           <span class="keywordflow">if</span>(found) {
00273             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00274             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00275             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00276               found = <span class="keyword">false</span>;
00277             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00278               <span class="comment">//Found a very big Neighbour</span>
00279               found = <span class="keyword">false</span>;
00280             }                                           
00281           }
00282           <span class="keywordflow">if</span>(!found) {
00283             yesBalanced = <span class="keyword">false</span>;
00284             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TR) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00285             failedEdges.push_back(nodes[i]);                                    
00286             <span class="keywordflow">break</span>;
00287           }
00288         }
00289 
00290       }
00291 
00292       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TL"&lt;&lt;NRM&lt;&lt;endl;</span>
00293       {
00294         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopLeft();
00295 
00296 
00297         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00298 
00299           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00300           <span class="keywordflow">if</span>(found) {
00301             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00302             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00303             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00304               found = <span class="keyword">false</span>;
00305             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00306               <span class="comment">//Found a very big Neighbour</span>
00307               found = <span class="keyword">false</span>;
00308             }                                           
00309           }
00310           <span class="keywordflow">if</span>(!found) {
00311             yesBalanced = <span class="keyword">false</span>;
00312             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TL) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00313             failedEdges.push_back(nodes[i]);                                    
00314             <span class="keywordflow">break</span>;
00315           }
00316         }
00317 
00318       }
00319 
00320       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoL"&lt;&lt;NRM&lt;&lt;endl;</span>
00321       {
00322         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomLeft();
00323 
00324 
00325         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00326 
00327           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00328           <span class="keywordflow">if</span>(found) {
00329             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00330             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00331             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00332               found = <span class="keyword">false</span>;
00333             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00334               <span class="comment">//Found a very big Neighbour</span>
00335               found = <span class="keyword">false</span>;
00336             }                                           
00337           }
00338           <span class="keywordflow">if</span>(!found) {
00339             yesBalanced = <span class="keyword">false</span>;
00340             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoL) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00341             failedEdges.push_back(nodes[i]);                                    
00342             <span class="keywordflow">break</span>;
00343           }
00344         }
00345 
00346       }
00347 
00348       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoR"&lt;&lt;NRM&lt;&lt;endl;</span>
00349       {
00350         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomRight();
00351 
00352 
00353         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00354 
00355           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00356           <span class="keywordflow">if</span>(found) {
00357             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00358             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00359             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00360               found = <span class="keyword">false</span>;
00361             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00362               <span class="comment">//Found a very big Neighbour</span>
00363               found = <span class="keyword">false</span>;
00364             }                                           
00365           }
00366           <span class="keywordflow">if</span>(!found) {
00367             yesBalanced = <span class="keyword">false</span>;
00368             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoR) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00369             failedEdges.push_back(nodes[i]);                                    
00370             <span class="keywordflow">break</span>;
00371           }
00372         }
00373 
00374       }
00375 
00376       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"RBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00377       {
00378         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getRightBack();
00379 
00380 
00381         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00382 
00383           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00384           <span class="keywordflow">if</span>(found) {
00385             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00386             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00387             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00388               found = <span class="keyword">false</span>;
00389             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00390               <span class="comment">//Found a very big Neighbour</span>
00391               found = <span class="keyword">false</span>;
00392             }                                           
00393           }
00394           <span class="keywordflow">if</span>(!found) {
00395             yesBalanced = <span class="keyword">false</span>;
00396             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (RBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00397             failedEdges.push_back(nodes[i]);                                    
00398             <span class="keywordflow">break</span>;
00399           }
00400         }
00401 
00402       }
00403 
00404       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00405       {
00406         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopBack();
00407 
00408 
00409         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00410 
00411           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00412           <span class="keywordflow">if</span>(found) {
00413             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00414             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00415             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00416               found = <span class="keyword">false</span>;
00417             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00418               <span class="comment">//Found a very big Neighbour</span>
00419               found = <span class="keyword">false</span>;
00420             }                                           
00421           }
00422           <span class="keywordflow">if</span>(!found) {
00423             yesBalanced = <span class="keyword">false</span>;
00424             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00425             failedEdges.push_back(nodes[i]);                                    
00426             <span class="keywordflow">break</span>;
00427           }
00428         }
00429 
00430       }
00431 
00432       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"LF"&lt;&lt;NRM&lt;&lt;endl;</span>
00433       {
00434         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getLeftFront();
00435 
00436 
00437         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00438 
00439           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00440           <span class="keywordflow">if</span>(found) {
00441             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00442             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00443             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00444               found = <span class="keyword">false</span>;
00445             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00446               <span class="comment">//Found a very big Neighbour</span>
00447               found = <span class="keyword">false</span>;
00448             }                                           
00449           }
00450           <span class="keywordflow">if</span>(!found) {
00451             yesBalanced = <span class="keyword">false</span>;
00452             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (LF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00453             failedEdges.push_back(nodes[i]);                                    
00454             <span class="keywordflow">break</span>;
00455           }
00456         }
00457 
00458       }
00459 
00460       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"LBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00461       {
00462         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getLeftBack();
00463 
00464 
00465         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00466 
00467           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00468           <span class="keywordflow">if</span>(found) {
00469             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00470             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00471             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00472               found = <span class="keyword">false</span>;
00473             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00474               <span class="comment">//Found a very big Neighbour</span>
00475               found = <span class="keyword">false</span>;
00476             }                                           
00477           }
00478           <span class="keywordflow">if</span>(!found) {
00479             yesBalanced = <span class="keyword">false</span>;
00480             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (LBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00481             failedEdges.push_back(nodes[i]);                                    
00482             <span class="keywordflow">break</span>;
00483           }
00484         }
00485 
00486       }
00487 
00488       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"RF"&lt;&lt;NRM&lt;&lt;endl;</span>
00489       {
00490         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getRightFront();
00491 
00492 
00493         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00494 
00495           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00496           <span class="keywordflow">if</span>(found) {
00497             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00498             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00499             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00500               found = <span class="keyword">false</span>;
00501             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00502               <span class="comment">//Found a very big Neighbour</span>
00503               found = <span class="keyword">false</span>;
00504             }                                           
00505           }
00506           <span class="keywordflow">if</span>(!found) {
00507             yesBalanced = <span class="keyword">false</span>;
00508             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (RF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00509             failedEdges.push_back(nodes[i]);                                    
00510             <span class="keywordflow">break</span>;
00511           }
00512         }
00513 
00514       }
00515 
00516       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TF"&lt;&lt;NRM&lt;&lt;endl;</span>
00517       {
00518         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopFront();
00519 
00520 
00521         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00522 
00523           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00524           <span class="keywordflow">if</span>(found) {
00525             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00526             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00527             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00528               found = <span class="keyword">false</span>;
00529             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00530               <span class="comment">//Found a very big Neighbour</span>
00531               found = <span class="keyword">false</span>;
00532             }                                           
00533           }
00534           <span class="keywordflow">if</span>(!found) {
00535             yesBalanced = <span class="keyword">false</span>;
00536             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00537             failedEdges.push_back(nodes[i]);                                    
00538             <span class="keywordflow">break</span>;
00539           }
00540         }
00541 
00542       }
00543 
00544       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00545       {
00546         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomBack();
00547 
00548 
00549         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00550 
00551           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00552           <span class="keywordflow">if</span>(found) {
00553             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00554             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00555             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00556               found = <span class="keyword">false</span>;
00557             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00558               <span class="comment">//Found a very big Neighbour</span>
00559               found = <span class="keyword">false</span>;
00560             }                                           
00561           }
00562           <span class="keywordflow">if</span>(!found) {
00563             yesBalanced = <span class="keyword">false</span>;
00564             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00565             failedEdges.push_back(nodes[i]);                                    
00566             <span class="keywordflow">break</span>;
00567           }
00568         }
00569 
00570       }
00571 
00572       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoF"&lt;&lt;NRM&lt;&lt;endl;</span>
00573       {
00574         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomFront();
00575 
00576 
00577         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00578 
00579           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00580           <span class="keywordflow">if</span>(found) {
00581             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00582             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00583             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00584               found = <span class="keyword">false</span>;
00585             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00586               <span class="comment">//Found a very big Neighbour</span>
00587               found = <span class="keyword">false</span>;
00588             }                                           
00589           }
00590           <span class="keywordflow">if</span>(!found) {
00591             yesBalanced = <span class="keyword">false</span>;
00592             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00593             failedEdges.push_back(nodes[i]);                                    
00594             <span class="keywordflow">break</span>;
00595           }
00596         }
00597 
00598       }
00599 
00600     }<span class="comment">//end if dim=3 or incCorn</span>
00601 
00602     <span class="keywordflow">if</span>(incCorn) {
00603       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TRBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00604       {
00605         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopRightBack();
00606 
00607 
00608         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00609 
00610           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00611           <span class="keywordflow">if</span>(found) {
00612             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00613             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00614             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00615               found = <span class="keyword">false</span>;
00616             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00617               <span class="comment">//Found a very big Neighbour</span>
00618               found = <span class="keyword">false</span>;
00619             }                                           
00620           }
00621           <span class="keywordflow">if</span>(!found) {
00622             yesBalanced = <span class="keyword">false</span>;
00623             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TRBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00624             failedCorners.push_back(nodes[i]);                                  
00625             <span class="keywordflow">break</span>;
00626           }
00627         }
00628 
00629       }
00630 
00631       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TLF"&lt;&lt;NRM&lt;&lt;endl;</span>
00632       {
00633         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopLeftFront();
00634 
00635 
00636         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00637 
00638           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00639           <span class="keywordflow">if</span>(found) {
00640             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00641             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00642             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00643               found = <span class="keyword">false</span>;
00644             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00645               <span class="comment">//Found a very big Neighbour</span>
00646               found = <span class="keyword">false</span>;
00647             }                                           
00648           }
00649           <span class="keywordflow">if</span>(!found) {
00650             yesBalanced = <span class="keyword">false</span>;
00651             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TLF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00652             failedCorners.push_back(nodes[i]);                                  
00653             <span class="keywordflow">break</span>;
00654           }
00655         }
00656 
00657       }
00658 
00659       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoRBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00660       {
00661         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomRightBack();
00662 
00663 
00664         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00665 
00666           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00667           <span class="keywordflow">if</span>(found) {
00668             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00669             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00670             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00671               found = <span class="keyword">false</span>;
00672             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00673               <span class="comment">//Found a very big Neighbour</span>
00674               found = <span class="keyword">false</span>;
00675             }                                           
00676           }
00677           <span class="keywordflow">if</span>(!found) {
00678             yesBalanced = <span class="keyword">false</span>;
00679             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoRBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00680             failedCorners.push_back(nodes[i]);                                  
00681             <span class="keywordflow">break</span>;
00682           }
00683         }
00684 
00685       }
00686 
00687       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TLBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00688       {
00689         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopLeftBack();
00690 
00691 
00692         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00693 
00694           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00695           <span class="keywordflow">if</span>(found) {
00696             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00697             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00698             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00699               found = <span class="keyword">false</span>;
00700             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00701               <span class="comment">//Found a very big Neighbour</span>
00702               found = <span class="keyword">false</span>;
00703             }                                           
00704           }
00705           <span class="keywordflow">if</span>(!found) {
00706             yesBalanced = <span class="keyword">false</span>;
00707             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TLBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00708             failedCorners.push_back(nodes[i]);                                  
00709             <span class="keywordflow">break</span>;
00710           }
00711         }
00712 
00713       }
00714 
00715       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoRF"&lt;&lt;NRM&lt;&lt;endl;</span>
00716       {
00717         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomRightFront();
00718 
00719 
00720         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00721 
00722           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00723           <span class="keywordflow">if</span>(found) {
00724             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00725             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00726             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00727               found = <span class="keyword">false</span>;
00728             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00729               <span class="comment">//Found a very big Neighbour</span>
00730               found = <span class="keyword">false</span>;
00731             }                                           
00732           }
00733           <span class="keywordflow">if</span>(!found) {
00734             yesBalanced = <span class="keyword">false</span>;
00735             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoRF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00736             failedCorners.push_back(nodes[i]);                                  
00737             <span class="keywordflow">break</span>;
00738           }
00739         }
00740 
00741       }
00742 
00743       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"TRF"&lt;&lt;NRM&lt;&lt;endl;</span>
00744       {
00745         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getTopRightFront();
00746 
00747 
00748         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00749 
00750           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00751           <span class="keywordflow">if</span>(found) {
00752             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00753             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00754             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00755               found = <span class="keyword">false</span>;
00756             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00757               <span class="comment">//Found a very big Neighbour</span>
00758               found = <span class="keyword">false</span>;
00759             }                                           
00760           }
00761           <span class="keywordflow">if</span>(!found) {
00762             yesBalanced = <span class="keyword">false</span>;
00763             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (TRF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00764             failedCorners.push_back(nodes[i]);                                  
00765             <span class="keywordflow">break</span>;
00766           }
00767         }
00768 
00769       }
00770 
00771 
00772       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoLBk"&lt;&lt;NRM&lt;&lt;endl;</span>
00773       {
00774         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomLeftBack();
00775 
00776 
00777         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00778 
00779           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00780           <span class="keywordflow">if</span>(found) {
00781             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00782             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00783             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00784               found = <span class="keyword">false</span>;
00785             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00786               <span class="comment">//Found a very big Neighbour</span>
00787               found = <span class="keyword">false</span>;
00788             }                                           
00789           }
00790           <span class="keywordflow">if</span>(!found) {
00791             yesBalanced = <span class="keyword">false</span>;
00792             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoLBk) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00793             failedCorners.push_back(nodes[i]);                                  
00794             <span class="keywordflow">break</span>;
00795           }
00796         }
00797 
00798 
00799       }
00800 
00801 
00802       <span class="comment">// cout&lt;&lt;RED&lt;&lt;"BoLF"&lt;&lt;NRM&lt;&lt;endl;</span>
00803       {
00804         <a class="code" href="classot_1_1TreeNode.html">TreeNode</a> it = nodes[i].getBottomLeftFront();
00805 
00806 
00807         <span class="keywordflow">if</span>(holder.<a class="code" href="classot_1_1TreeNode.html#a11">isAncestor</a>(it)){
00808 
00809 
00810           <span class="keywordtype">bool</span> found = <a class="code" href="namespaceseq.html#a4">seq::maxLowerBound</a>(nodes,it.<a class="code" href="classot_1_1TreeNode.html#a6">getDFD</a>(), retIdx,NULL,NULL);
00811           <span class="keywordflow">if</span>(found) {
00812             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> retLev = nodes[retIdx].getLevel();
00813             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> myLev = nodes[i].getLevel();                                   
00814             <span class="keywordflow">if</span>( (it.<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>() != nodes[retIdx].<a class="code" href="classot_1_1TreeNode.html#z19_2">getAnchor</a>()) &amp;&amp; (!(nodes[retIdx].isAncestor(it))) ) {
00815               found = <span class="keyword">false</span>;
00816             }<span class="keywordflow">else</span> <span class="keywordflow">if</span>( (retLev &lt; myLev) &amp;&amp; ( (myLev - retLev) &gt; maxLevDiff ) ) {
00817               <span class="comment">//Found a very big Neighbour</span>
00818               found = <span class="keyword">false</span>;
00819             }                                           
00820           }
00821           <span class="keywordflow">if</span>(!found) {
00822             yesBalanced = <span class="keyword">false</span>;
00823             std::cout&lt;&lt;nodes[i]&lt;&lt;<span class="stringliteral">": (BoLF) -&gt;"</span>&lt;&lt;nodes[retIdx]&lt;&lt;std::endl;
00824             failedCorners.push_back(nodes[i]);                                  
00825             <span class="keywordflow">break</span>;
00826           }
00827         }
00828 
00829       }
00830 
00831     }<span class="comment">//end if incCorn</span>
00832 
00833   }<span class="comment">//end for i</span>
00834 
00835   <a class="code" href="namespaceseq.html#a1">seq::makeVectorUnique</a>(failedFaces,<span class="keyword">false</span>);
00836   <a class="code" href="namespaceseq.html#a1">seq::makeVectorUnique</a>(failedEdges,<span class="keyword">false</span>);
00837   <a class="code" href="namespaceseq.html#a1">seq::makeVectorUnique</a>(failedCorners,<span class="keyword">false</span>);
00838   <span class="keywordtype">char</span> failCornerFileName[100];
00839   <span class="keywordtype">char</span> failEdgeFileName[100];
00840   <span class="keywordtype">char</span> failFaceFileName[100];
00841   strcpy(failFaceFileName,failFileName );
00842   strcpy(failEdgeFileName,failFileName);
00843   strcpy(failCornerFileName,failFileName);
00844   strcat(failFaceFileName,<span class="stringliteral">"_Faces.ot\0"</span>);       
00845   strcat(failEdgeFileName,<span class="stringliteral">"_Edges.ot\0"</span>);       
00846   strcat(failCornerFileName,<span class="stringliteral">"_Corners.ot\0"</span>);   
00847   <a class="code" href="namespaceot.html#a53">writeNodesToFile</a>(failCornerFileName,failedCorners);
00848   <a class="code" href="namespaceot.html#a53">writeNodesToFile</a>(failEdgeFileName,failedEdges);
00849   <a class="code" href="namespaceot.html#a53">writeNodesToFile</a>(failFaceFileName,failedFaces);
00850   <span class="keywordflow">return</span> yesBalanced;
00851 }<span class="comment">//end function</span>
00852 
00853 }<span class="comment">//end namespace</span>
00854 }<span class="comment">//end namespace</span>
00855 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 10 11:31:34 2008 for DENDRO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
